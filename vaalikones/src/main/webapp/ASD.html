<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title></title>
 <style>
    h1 { color: #FF0000; }
    h3 { color: #FF0000; }
  </style>
</head>
<body bgcolor="#E6E6FA">
 
	<h1>EHDOKKAAT</h1>
	<br>

	<h3>Näytä ehdokkaat: </h3>
	<button onclick="show()">Näytä ehdokkaat</button>
	<div id="kaikkiehdokkaatkentta"></div>
	
	
	<h3>Muokkaa tai lisää ehdokas</h3>
	<br>
	<form id="tiedot" onsubmit="return false">
		Ehdokas ID:<br> <input type="text" name="EHDOKAS_ID" value=1>
		<br>
		Sukunimi:<br> <input type="text" name="SUKUNIMI"value=""> 
		<br> 
		Etunimi:<br> <input type="text"
		name="ETUNIMI" value="">
		<br>
		Puolue:<br> <input type="text" name="PUOLUE" value="">
		<br>
		Kotipaikkakunta:<br> <input type="text" name="KOTIPAIKKAKUNTA"value="">
		<br>
		Ikä:<br> <input type="text"name="IKA" value=0> 
		<br>
		Miksi Eduskuntaan:<br> <input type="text" name="MIKSI_EDUSKUNTAAN" value=""> 
		<br>
		Mitä Asioita haluat edistää:<br> <input type="text" name="MITA_ASIOITA_HALUAT_EDISTAA" value=""> 
		<br>
		Ammatti:<br> <input type="text" name="AMMATTI" value="">

	</form>
	<button onclick="Lue(t1)">Muokkaa ehdokasta</button>
	<div id="a"></div>

	</form>
	<button onclick="Lue(t2)">Lisää ehdokas</button>
	<div id="b"></div>


	<h3>Ehdokkaan poistaminen</h3>

	<form id="del" onsubmit="return false">
		<input type="text" name="poistaid" value="" placeholder="Ehdokas id">
		<button onclick="setUrl()">Poista ehdokas</button>
	</form>
	
	<div id="inner"></div>
	
	<script>
		function setUrl(){
			var d = document.getElementById("del").poistaid.value;
			var url = "./rest/ehd/poista/" + d;
			
				var xhttp = new XMLHttpRequest();
				xhttp.onreadystatechange = function() {
					  if (this.readyState == 4 && this.status == 200) {
					    document.getElementById("inner").innerHTML = this.responseText;
					  }
					};
				xhttp.open("GET", url, true);						
				xhttp.send();
			
		}
	</script>
	
	<script>
		function show(){
			var url = "./rest/ehd/kaikki";
			var xhttp = new XMLHttpRequest();
			var setit = [];
			xhttp.onreadystatechange = function() {
				  if (this.readyState == 4 && this.status == 200) {
					  jsn = JSON.parse(this.responseText);

					  for (var i = 0;i <= jsn.length-1; i++){
						  
						  setit[i] = JSON.parse(this.responseText)[i];
						  
						  console.log(setit[i].etunimi);
						  document.getElementById("kaikkiehdokkaatkentta").innerHTML +=
							  "Ehdokas ID: " + setit[i].ehdokasId + 
							  " Sukunimi: " + setit[i].sukunimi + 
							  "   Etunimi: " +setit[i].etunimi + "<br>";
					  }
				    
				  }
				};
			xhttp.open("GET", url, true);
			xhttp.send();
		}
	</script>
	
	<script>
		var t2 = "t2";
		var t1 = "t1";
		function Lue(t) {
			var tiedot = document.getElementById("tiedot");
			var urli;
			if (t === t1) {
				urli = "./rest/ehd/a";
			}
			if (t === t2) {
				urli = "./rest/ehd/b";
			}
			var ehdokas = new Object();

			ehdokas.ehdokasId = tiedot.EHDOKAS_ID.value;
			ehdokas.sukunimi = tiedot.SUKUNIMI.value;
			ehdokas.etunimi = tiedot.ETUNIMI.value;
			ehdokas.puolue = tiedot.PUOLUE.value;
			ehdokas.kotipaikkakunta = tiedot.KOTIPAIKKAKUNTA.value;
			ehdokas.ika = tiedot.IKA.value;
			ehdokas.miksiEduskuntaan = tiedot.MIKSI_EDUSKUNTAAN.value;
			ehdokas.mitaAsioitaHaluatEdistaa = tiedot.MITA_ASIOITA_HALUAT_EDISTAA.value;
			ehdokas.ammatti = tiedot.AMMATTI.value;

			var asd = JSON.stringify(ehdokas);

			//debug iffit
			if (t === t1) {
				document.getElementById("a").innerHTML = "Ehdokkaan tiedot muokattu!";
			} else {
				document.getElementById("b").innerHTML = "Uusi ehdokas lisätty!";
			}


			var xhttp = new XMLHttpRequest();
			xhttp.open("POST", urli, true);

			xhttp.setRequestHeader("Content-type", "application/json");
			xhttp.send(asd);

		}
	</script>

	<br>
</body>
</html>
